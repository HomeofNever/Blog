(window.webpackJsonp=window.webpackJsonp||[]).push([[31],{135:function(e,t,v){e.exports={srcSet:v.p+"0c01edb7cb9312c5f2f4b80434521de1-1200.png 1200w,"+v.p+"ecdc97f8cc432f226f25219efcca49f9-720.png 720w,"+v.p+"5c9848baae689a4790c353f2ec838e89-480.png 480w",images:[{path:v.p+"0c01edb7cb9312c5f2f4b80434521de1-1200.png",width:1200,height:420},{path:v.p+"ecdc97f8cc432f226f25219efcca49f9-720.png",width:720,height:252},{path:v.p+"5c9848baae689a4790c353f2ec838e89-480.png",width:480,height:168}],src:v.p+"0c01edb7cb9312c5f2f4b80434521de1-1200.png",toString:function(){return v.p+"0c01edb7cb9312c5f2f4b80434521de1-1200.png"},placeholder:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAOCAYAAABdC15GAAAB+klEQVR4AbXBy2pVdxjG4d/7/b+11s5OspKAg7YoBQMZOulldFZoh95Cr0xnXo5KIYNCKYnktLNOr9nZDSqpuHPweeQrfMU4jpRS+BbbvP3rkIgCEtM48PPTH6kyeag0XxelYNYg8eynH1hcdiz6gVldkZmYh0tsHkNdJXWVtPzHZmnRDZj7y77v+fDhCDDtdkvTNDwaFRAwjkzjQNf37LQtEYV1dMNA1lXPk/M3HG/9wunJ3ywuCraxjSSWSgm2tze5u6csZSaqG2ZzKCHuIqGgZ7/SnF9wTeKGJyMJ25ydGSkwZkksCWOqTOq64hYFMGEFi8FURWRwJzm64ei4Icqc2WzG58SK+ER8ScAALDqxmMRJN/H63cDzVvy2X4AJszLZDBNkiHVlCHZ3Wh6qAmaGvabw54uCBBLXQlACBPQTZLC27LqOo+NjJBES8/km8/mc70ESGynuIrOqISqyqmiaGkVw0fXcx6v3I4dn5uVBxUbC3iy5IcCGy8E0KdaVEuzttjyGP/aTL4hr0zgRrNiw6FiLbdKGf/49woatzTlNU3Nfr96PHJ6ZlwcVGwl1ckWcnl9gG0nYJiSySoQAs2RACDA3SimkgN2dlhERrESI+/h9P/k/EYFtJFFKUKIAZkWsCDAQgLkmkRFia6Phe5o1NbeJ28SKuPERIRqxJO4GzCgAAAAASUVORK5CYII=",width:1200,height:420}},184:function(e,t,v){"use strict";v.r(t);var a=v(0),_=function(e){var t,v,a,_,i,r,o,n,p,c=(a=void 0,_="github action",i="twitter",r="telegram",o="sync",n="剧情前提",p="since_id",(t={}).type=v="post",t.internal=a,t.contentType="markdown",t.slug="tweet-to-telegram",t.content=a,t.createdAt=new Date(1610064e6),t.updatedAt=new Date(1655891906917),t.title="用 Github Action 拯救 Twitter 与 Telegram 的转发",t.tags=[_,i,r,o],t.categories=["技术"],t.layout=v,t.date="2021-01-08",t.description="自动获取点赞推文图片/视频, 转发到Telegram频道, 咳咳",t.markdownHeadings=[{text:n,slug:n,level:2},{text:"IFTTT的困境",slug:"ifttt的困境",level:3},{text:"正文",slug:"正文",level:2},{text:"申请API",slug:"申请api",level:3},{text:"创建APP",slug:"创建app",level:3},{text:"Github Action",slug:"github-action",level:3},{text:p,slug:p,level:4},{text:"后言",slug:"后言",level:2}],t.excerpt='<p>如果你想直接看成品: <a href="https://github.com/NeverBehave/Tweet2Telegram">https://github.com/NeverBehave/Tweet2Telegram</a></p>\n',t.permalink="/2021/01/08/tweet-to-telegram",t.assets={},t.attributes=t,t.tagsInfo=[{name:_,permalink:"/blog/tag/github-action"},{name:i,permalink:"/blog/tag/twitter"},{name:r,permalink:"/blog/tag/telegram"},{name:o,permalink:"/blog/tag/sync"}],t.categoriesInfo=[{name:"技术",permalink:"/blog/category/technology"}],t),l=e.options.beforeCreate||[];e.options.beforeCreate=[function(){this.$page=c}].concat(l);["layout","transition"].forEach((function(t){var v=e.options.PageComponent;v&&(e.options[t]=v[t]),void 0===e.options[t]&&(e.options[t]=c[t])})),c.slug&&(e.options.name="page-wrapper-"+c.slug.replace(/[^0-9a-z\-]/gi,"-"))},i=Object(a.a)({},(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("layout-manager",[a("blockquote",[a("p",[e._v("如果你想直接看成品: "),a("saber-link",{attrs:{to:"https://github.com/NeverBehave/Tweet2Telegram"}},[e._v("https://github.com/NeverBehave/Tweet2Telegram")])],1)]),e._v(" "),a("h2",{attrs:{id:"剧情前提"}},[e._v("剧情前提")]),e._v(" "),a("p",[e._v("推特上有太多好 "),a("s",[e._v("(毛毛)(色)(不你什么都不知道)")]),e._v(" 图/视频了, 然而每次想找点回来的时候却...翻起来好麻烦啊")]),e._v(" "),a("p",[e._v("然而每次保存下来好麻烦, 要是点赞了以后可以自动保存下来就好了")]),e._v(" "),a("p",[e._v("于是我又动起了IFTTT的念头...因为IFTTT也有推特点赞转发啊! 我之前还做过一期"),a("saber-link",{attrs:{to:"./customize-telegram-twitter-ifttt-connection.md"}},[e._v("如何用IFTTT配合推特转发到个人频道")]),e._v("；甚至还买了Pro")],1),e._v(" "),a("p",[e._v("但是如果是这样的话, 文章标题怎么感觉有点不对呢...?")]),e._v(" "),a("h3",{attrs:{id:"ifttt的困境"}},[e._v("IFTTT的困境")]),e._v(" "),a("p",[e._v("IFTTT这个东西嘛, 简单点的就算了, 这回我们的需求是:")]),e._v(" "),a("ol",[a("li",[e._v("获取点赞的推文")]),e._v(" "),a("li",[e._v("解析其中所有的视频/图片/链接")]),e._v(" "),a("li",[e._v("转发到Telegram频道")])]),e._v(" "),a("p",[e._v("然而呢, IFTTT")]),e._v(" "),a("ol",[a("li",[e._v("其中的图片/视频链接不是直链")]),e._v(" "),a("li",[e._v("Webhook有频率限制")]),e._v(" "),a("li",[a("strong",[e._v("甚至, IFTTT似乎实现错了这个功能")]),e._v("(后文详述)")])]),e._v(" "),a("p",[e._v("直链这个解析实在是难以描述, 如果不通过推特官方的API: 他默认做了很多对爬虫不友好的操作")]),e._v(" "),a("p",[e._v("一番测试下来发现效果真的很差, 很容易错过点赞")]),e._v(" "),a("p",[e._v("于是...那就看看推特的API然后自己做一套吧")]),e._v(" "),a("h2",{attrs:{id:"正文"}},[e._v("正文")]),e._v(" "),a("h3",{attrs:{id:"申请api"}},[e._v("申请API")]),e._v(" "),a("p",[e._v("首先, 我们需要申请一下开发者API, "),a("saber-link",{attrs:{to:"https://developer.twitter.com/en/apply-for-access"}},[e._v("申请链接")])],1),e._v(" "),a("p",[e._v("在申请的时候他会让选择你的用途并描述你要做什么, 至少"),a("code",{pre:!0},[e._v("200 characters")]),e._v(", 不是"),a("code",{pre:!0},[e._v("words")]),e._v(". 也就是说差不多2-3句话差不多了")]),e._v(" "),a("p",[e._v("这个做完以后就等着邮箱发信给你, 确认一下. 我刚填完就收到了邮件, 基本上体验还好")]),e._v(" "),a("h3",{attrs:{id:"创建app"}},[e._v("创建APP")]),e._v(" "),a("figure",[a("saber-image",{attrs:{src:v(135),alt:"","data-lazy":"{}"}})],1),e._v(" "),a("p",[e._v("一开始他默认会给你创建一个项目, 然后你在里面可以创建你的第一个APP. 但是注意一下, 除了"),a("code",{pre:!0},[e._v("API_KEY")]),e._v("和"),a("code",{pre:!0},[e._v("API_SECRET")]),e._v(", 他还有一个"),a("code",{pre:!0},[e._v("ACCESS_TOKEN")]),e._v(". 这个对应的是用户的数据访问, 也就是说你这个APP代表的是哪个用户做事情. 我们目前是要获取自己帐号的点赞列表, 所以直接看下面"),a("code",{pre:!0},[e._v("Authentication Tokens")]),e._v(" 获取自己的就好")]),e._v(" "),a("h3",{attrs:{id:"github-action"}},[e._v("Github Action")]),e._v(" "),a("p",[e._v("然后就是我们的重头戏上场: "),a("saber-link",{attrs:{to:"https://github.com/NeverBehave/Tweet2Telegram"}},[e._v("https://github.com/NeverBehave/Tweet2Telegram")])],1),e._v(" "),a("p",[e._v("默认15分钟获取一次, 目前来看效果不错")]),e._v(" "),a("p",[e._v("甚至说实话, 我觉得转发也可以改成这个, 不知道好到哪里去了:")]),e._v(" "),a("ul",[a("li",[e._v("不需要麻烦的获取链接跳转再替换")]),e._v(" "),a("li",[e._v("视频/图片原生就在Telegram, 无需Web Preiew")])]),e._v(" "),a("p",[e._v("写完以后感受: 推特的API其实还蛮舒服的, 当然如果只是个人使用的话. 一开始被"),a("code",{pre:!0},[e._v("IFTTT")]),e._v("坑的不要不要的, 现在看来其实还好")]),e._v(" "),a("p",[e._v("这里, 我想提一下这个很有意思的API问题 (Aka IFTTT干的好事)")]),e._v(" "),a("h4",{attrs:{id:"since_id"}},[a("code",{pre:!0},[e._v("since_id")])]),e._v(" "),a("p",[e._v("这是我也踩了一脚坑, 意识到以后重新观察了一下"),a("code",{pre:!0},[e._v("IFTTT")]),e._v("的行为, 估计是一样的")]),e._v(" "),a("p",[e._v("获取点赞列表的时候, 其中一个参数是叫做"),a("code",{pre:!0},[e._v("since_id")]),e._v("("),a("saber-link",{attrs:{to:"https://developer.twitter.com/en/docs/twitter-api/v1/tweets/post-and-engage/api-reference/get-favorites-list"}},[e._v("官方文档")]),e._v("), 这个东西的意思是说返回所有"),a("strong",[e._v("从这个"),a("code",{pre:!0},[e._v("ID")]),e._v("开始的所有推文")]),e._v(". 放在这个上下文是不是很容易理解为"),a("strong",[e._v("如果你点赞了的一条推文, 我记住它, 那么下次我获取新的点赞的时候, 给这个推文的"),a("code",{pre:!0},[e._v("ID")]),e._v(", 就可以获取从这个点赞以后的推文了")])],1),e._v(" "),a("p",[e._v("不是的!!!!!! 这个的意思纯粹是说"),a("strong",[e._v("按照时间顺序, 比你给的这个"),a("code",{pre:!0},[e._v("ID")]),e._v("新的所有你喜欢的推文")])]),e._v(" "),a("p",[e._v("所以当你点赞了一条今天发送的推文, 然后去点赞了一条昨天发送的推文, 那么你就获取不到这个"),a("strong",[e._v("新")]),e._v("的点赞了")]),e._v(" "),a("p",[e._v("我发现IFTTT就有类似的行为, 他总是检测不到一些点赞, 估计他的"),a("strong",[e._v("新点赞的推文")]),e._v("也就是靠这个ID判断的, 实际上是错的!")]),e._v(" "),a("p",[e._v("但是实际上API文档里面写的很清楚了是时间顺序, 所以还是自己傻逼了, 抚额")]),e._v(" "),a("h2",{attrs:{id:"后言"}},[e._v("后言")]),e._v(" "),a("p",[e._v("大部分的参数在项目里面提供了, 我就不在这里重新描述了, "),a("s",[e._v("其实这就是水文")])]),e._v(" "),a("p",[e._v("然后就是这个IFTTT的bug, 不知道去哪里报一下")])])}),[],!1,null,null,null);"function"==typeof _&&_(i);t.default=i.exports}}]);